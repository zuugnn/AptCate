<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <title>jQuery Cascading Dropdown Plugin Examples</title>
        <meta name="description" content="" />
        <meta name="viewport" content="width=device-width" />

        <!-- Stylesheets here -->
        <link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.0/css/bootstrap.min.css" />
        <style type="text/css">
            .b-docs-example {
                position: relative;
                margin: 15px 0;
                padding: 39px 19px 14px;
                background-color: #fff;
                border: 1px solid #ddd;
                -webkit-border-radius: 4px;
                -moz-border-radius: 4px;
                border-radius: 4px;
            }

            .b-docs-example:after {
                content: "Example";
                position: absolute;
                top: -1px;
                left: -1px;
                padding: 3px 7px;
                font-size: 12px;
                font-weight: bold;
                background-color: #f5f5f5;
                border: 1px solid #ddd;
                color: #9da0a4;
                -webkit-border-radius: 4px 0 4px 0;
                -moz-border-radius: 4px 0 4px 0;
                border-radius: 4px 0 4px 0;
            }

            .cascading-dropdown-loading {
                cursor: wait;
                background: url("res/ajax-loader.gif") 85% center no-repeat transparent;
            }
        </style>
        <link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.css" />
        <link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shThemeDefault.css" />
    </head>
    <body>
        <div class="container">
            <div class="page-header">
                <h1>jQuery Cascading Dropdown <small>Examples</small></h1>
            </div>

            
           

            <h4>Dynamic</h4>
            

            <div id="example2" class="bs-docs-example">
                <h4>Phone finder</h4>

                <select class="step1" name="sido">
                    <option value="">시/도</option>
                </select>
                <select class="step2" name="gungu">
                    <option value="">군/구</option>
                </select>
                <select class="step3" name="dong">
                    <option value="">동</option>
                </select>

                <h4>Matches <img src="res/ajax-loader.gif" data-bind="visible: loading" /></h4>
                <ul data-bind="foreach: apts, visible: apts().length > 0">
                    <li>
                        <span data-bind="text: maker"></span>
                        <span data-bind="text: model"></span>
                    </li>
                </ul>
                <p data-bind="visible: apts().length == 0">No matches</p>
            </div>

            <h6>Code</h6>
            <div>
                <pre class="brush: js">
                    $('#example2').cascadingDropdown({
                        selectBoxes: [
                            {
                                selector: '.step1',
                                source: [
                                    { label: '4.0"', value: 4 },
                                    { label: '4.3"', value: 4.3 },
                                    { label: '4.7"', value: 4.7 },
                                    { label: '5.0"', value: 5 }
                                ]
                            },
                            {
                                selector: '.step2',
                                requires: ['.step1'],
                                source: function(request, response) {
                                    $.getJSON('/api/resolutions', request, function(data) {
                                        var selectOnlyOption = data.length <= 1;
                                        response($.map(data, function(item, index) {
                                            return {
                                                label: item + 'p',
                                                value: item,
                                                selected: selectOnlyOption // Select if only option
                                            };
                                        }));
                                    });
                                }
                            },
                            {
                                selector: '.step3',
                                requires: ['.step1', '.step2'],
                                requireAll: true,
                                source: function(request, response) {
                                    $.getJSON('/api/storages', request, function(data) {
                                        response($.map(data, function(item, index) {
                                            return {
                                                label: item + ' GB',
                                                value: item,
                                                selected: index == 0 // Select first available option
                                            };
                                        }));
                                    });
                                },
                                onChange: function(event, value, requiredValues, requirementsMet){
                                    // do stuff
                                }
                            }
                        ]
                    });
                </pre>
            </div>

            <br />

            

        <!-- Scripts here -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/knockout/2.3.0/knockout-min.js"></script>
        <script type="text/javascript" src="res/cate_data.js"></script>
        <script type="text/javascript" src="dist/jquery.cascadingdropdown.min.js"></script>
        <script type="text/javascript">
            function viewmodel() {
                this.apts = ko.observableArray([]);
                this.loading = ko.observable(false);
            }

            var example2 = new viewmodel();

            ko.applyBindings(example2, document.getElementById("example2"));
            

            // Basic
            /*
            $("#example1").cascadingDropdown({
                selectBoxes: [
                    {
                        selector: ".step1",
                        selected: "4.3",
                    },
                    {
                        selector: ".step2",
                        requires: [".step1"],
                    },
                    {
                        selector: ".step3",
                        requires: [".step1", ".step2"],
                        onChange: function (event, value, requiredValues, requirementsMet) {
                            if (!requirementsMet) return;

                            example1.loading(true);

                            console.log(event, value, requiredValues, requirementsMet);

                            var ajaxData = requiredValues;
                            ajaxData[this.el.attr("name")] = value;
                            $.getJSON("/api/phones", ajaxData, function (data) {
                                example1.phones(data);
                                example1.loading(false);
                            });
                        },
                    },
                ],
            });
            */

            // Dynamic
            $("#example2").cascadingDropdown({
                selectBoxes: [
                    {
                        selector: ".step1",
                        source: [
                            { label: "서울시", value: 77 },
                            { label: "경기도", value: 99 },
                        ],
                    },
                    {
                        selector: ".step2",
                        requires: [".step1"],
                        source: function (request, response) {
                            data = subCate[request["sido"]];

                            var selectOnlyOption = data.length <= 1;
                            response(
                                $.map(data, function (item, index) {
                                    return {
                                        label: item.name,
                                        value: item.cate_no,
                                        selected: selectOnlyOption,
                                    };
                                })
                            );
                        },
                    },
                    {
                        selector: ".step3",
                        requires: [".step1", ".step2"],
                        requireAll: true,
                        source: function (request, response) {
                            data = subCate[request["gungu"]];

                            var selectOnlyOption = data.length <= 1;
                            response(
                                $.map(data, function (item, index) {
                                    return {
                                        label: item.name,
                                        value: item.cate_no,
                                        selected: selectOnlyOption,
                                    };
                                })
                            );
                        },
                        onChange: function (event, value, requiredValues, requirementsMet) {
                            if (!requirementsMet) return;

                            example2.loading(true);

                            var ajaxData = requiredValues;
                            ajaxData[this.el.attr("name")] = value;
                            $.getJSON("/api/phones", ajaxData, function (data) {
                                example2.apts(data);
                                example2.loading(false);
                            });
                        },
                    },
                ],
            });

            /*
            // Combined
            $("#example3").cascadingDropdown({
                selectBoxes: [
                    {
                        selector: ".step1",
                    },
                    {
                        selector: ".step2",
                        source: function (request, response) {
                            $.getJSON("/api/resolutions", request, function (data) {
                                response(
                                    $.map(data, function (item, index) {
                                        return {
                                            label: item + "p",
                                            value: item,
                                            selected: index == 0,
                                        };
                                    })
                                );
                            });
                        },
                    },
                    {
                        selector: ".step3",
                        requires: [".step1", ".step2"],
                        requireAll: true,
                        source: function (request, response) {
                            $.getJSON("/api/storages", request, function (data) {
                                response(
                                    $.map(data, function (item, index) {
                                        return {
                                            label: item + " GB",
                                            value: item,
                                            selected: index == 0,
                                        };
                                    })
                                );
                            });
                        },
                    },
                ],
                onChange: function (event, dropdownData) {
                    example3.loading(true);
                    $.getJSON("/api/phones", dropdownData, function (data) {
                        example3.phones(data);
                        example3.loading(false);
                    });
                },
                onReady: function (event, dropdownData) {
                    example3.loading(true);
                    $.getJSON("/api/phones", dropdownData, function (data) {
                        example3.phones(data);
                        example3.loading(false);
                    });
                },
            });

            // Multiple select
            $("#example4").cascadingDropdown({
                selectBoxes: [
                    {
                        selector: ".step1",
                        selected: [1, 2],
                        onChange: function (e, selected) {
                            console.log(selected);
                        },
                    },
                    {
                        selector: ".step2",
                        source: function (request, response) {
                            $.getJSON("/api/resolutions", request, function (data) {
                                response(
                                    $.map(data, function (item, index) {
                                        return {
                                            label: item + "p",
                                            value: item,
                                            selected: index == 0,
                                        };
                                    })
                                );
                            });
                        },
                    },
                    {
                        selector: ".step3",
                        requires: [".step1", ".step2"],
                        requireAll: true,
                        source: function (request, response) {
                            $.getJSON("/api/storages", request, function (data) {
                                response(
                                    $.map(data, function (item, index) {
                                        return {
                                            label: item + " GB",
                                            value: item,
                                            selected: index == 0,
                                        };
                                    })
                                );
                            });
                        },
                    },
                ],
                onChange: function (event, dropdownData) {
                    example4.loading(true);
                    $.getJSON("/api/phones", dropdownData, function (data) {
                        example4.phones(data);
                        example4.loading(false);
                    });
                },
                onReady: function (event, dropdownData) {
                    example4.loading(true);
                    $.getJSON("/api/phones", dropdownData, function (data) {
                        example4.phones(data);
                        example4.loading(false);
                    });
                },
            });

            // Option Group
            $("#example5").cascadingDropdown({
                selectBoxes: [
                    {
                        selector: ".step1",
                    },
                    {
                        selector: ".step2",
                        source: function (request, response) {
                            $.getJSON("/api/resolutionsGrouped", request, function (data) {
                                var newData = {};
                                $.each(data, function (key, value) {
                                    newData[key] = $.map(value, function (item, index) {
                                        return {
                                            label: item + "p",
                                            value: item,
                                        };
                                    });
                                });

                                response(newData);
                            });
                        },
                    },
                    {
                        selector: ".step3",
                        requires: [".step1", ".step2"],
                        requireAll: true,
                        source: function (request, response) {
                            $.getJSON("/api/storages", request, function (data) {
                                response(
                                    $.map(data, function (item, index) {
                                        return {
                                            label: item + " GB",
                                            value: item,
                                            selected: index == 0, // set to true to mark it as the selected item
                                        };
                                    })
                                );
                            });
                        },
                    },
                ],
                onChange: function (event, dropdownData) {
                    example5.loading(true);
                    $.getJSON("/api/phones", dropdownData, function (data) {
                        example5.phones(data);
                        example5.loading(false);
                    });
                },
                onReady: function (event, dropdownData) {
                    example5.loading(true);
                    $.getJSON("/api/phones", dropdownData, function (data) {
                        example5.phones(data);
                        example5.loading(false);
                    });
                },
            });
            */
        </script>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.js"></script>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJScript.js"></script>
        <script type="text/javascript">
            SyntaxHighlighter.all();
        </script>
    </body>
</html>
